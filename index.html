<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Glyph System — Fey Blood Arcana</title>
  <meta name="description" content="Fey Blood Arcana — Analysis & Compendium. An interactive guide to a glyph-based magic system.">
  <style>
    html, body, #root {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: #0d0a14;
    }
  </style>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.3.1/umd/react.production.min.js"></script>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.3.1/umd/react-dom.production.min.js"></script>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.26.2/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
const { useState } = React;

const BODY_ZONES = [
  { id: "head", label: "Head & Face", area: 4, x: 50, y: 8, w: 14, h: 8, smallMax: 6, largeMax: 2 },
  { id: "neck", label: "Neck", area: 1.5, x: 50, y: 16, w: 8, h: 3, smallMax: 3, largeMax: 1 },
  { id: "chest", label: "Chest", area: 12, x: 50, y: 24, w: 22, h: 12, smallMax: 16, largeMax: 5 },
  { id: "abdomen", label: "Abdomen", area: 8, x: 50, y: 37, w: 20, h: 8, smallMax: 12, largeMax: 4 },
  { id: "upperBackL", label: "Left Upper Arm", area: 5, x: 30, y: 24, w: 8, h: 14, smallMax: 8, largeMax: 3 },
  { id: "upperBackR", label: "Right Upper Arm", area: 5, x: 70, y: 24, w: 8, h: 14, smallMax: 8, largeMax: 3 },
  { id: "forearmL", label: "Left Forearm", area: 4, x: 24, y: 40, w: 6, h: 14, smallMax: 6, largeMax: 2 },
  { id: "forearmR", label: "Right Forearm", area: 4, x: 76, y: 40, w: 6, h: 14, smallMax: 6, largeMax: 2 },
  { id: "handL", label: "Left Hand", area: 2, x: 20, y: 55, w: 6, h: 6, smallMax: 4, largeMax: 1 },
  { id: "handR", label: "Right Hand", area: 2, x: 80, y: 55, w: 6, h: 6, smallMax: 4, largeMax: 1 },
  { id: "thighL", label: "Left Thigh", area: 8, x: 42, y: 50, w: 9, h: 16, smallMax: 12, largeMax: 4 },
  { id: "thighR", label: "Right Thigh", area: 8, x: 58, y: 50, w: 9, h: 16, smallMax: 12, largeMax: 4 },
  { id: "shinL", label: "Left Shin", area: 5, x: 41, y: 68, w: 7, h: 16, smallMax: 8, largeMax: 2 },
  { id: "shinR", label: "Right Shin", area: 5, x: 59, y: 68, w: 7, h: 16, smallMax: 8, largeMax: 2 },
  { id: "back", label: "Back", area: 14, x: 50, y: 30, w: 22, h: 16, smallMax: 20, largeMax: 6, hidden: true },
];

const SPELL_TIERS = [
  { name: "Cantrip", size: "small", color: "#7ec8e3" },
  { name: "Standard", size: "medium", color: "#c4a7e7" },
  { name: "Greater", size: "large", color: "#f6c177" },
  { name: "Grand", size: "xlarge", color: "#eb6f92" },
];

const ANALYSIS_SECTIONS = [
  {
    id: "mechanics",
    title: "Core Mechanics",
    icon: "◈",
    content: {
      principles: [
        {
          name: "The Fey Blood Tether",
          text: "Glyphs must be written in Fey blood — not any magical ink, but blood specifically from creatures connected to Arcadia, the plane of magic. Magic isn't generated by the caster, it's channeled through a material bridge to another plane. The caster is a conduit, not a source."
        },
        {
          name: "Skin-Contact Activation",
          text: "The glyph must touch the caster's bare skin. This means the body itself is the final component of the spell circuit — Fey blood (Arcadia) + glyph pattern (intent) + living skin (conduit) = spell. Clothing, gloves, or armor between skin and glyph would break the circuit."
        },
        {
          name: "Consumable Spellcasting",
          text: "Glyphs are single-use. When activated, the blood ink glows faintly and then erases from existence — not smearing or burning away, but ceasing to exist. This implies the blood is returning to Arcadia, the bridge closing as the spell fires. Every spell cast is a resource permanently spent."
        },
        {
          name: "Will-Based Trigger",
          text: "Activation requires only willpower and skin contact. No verbal components, no somatic gestures, no focus items. This makes spellcasting silent and subtle — a combat caster could fire a spell mid-conversation with no outward sign except the faint glow bleeding through their clothes."
        }
      ]
    }
  },
  {
    id: "casting",
    title: "Casting Paradigms",
    icon: "⊛",
    content: {
      paradigms: [
        {
          name: "The Scholar — Grimoire Casting",
          traits: ["Utility-focused", "Vast spell repertoire", "Slow activation", "Safe & measured"],
          description: "Grimoire casters carry books of blood-inked glyphs, one per page. They trade speed for versatility — hundreds of spells at their fingertips, but flipping to the right page under pressure is dangerous. These are researchers, healers, enchanters, and problem-solvers. In combat, they're support at best.",
          implications: [
            "Indexing and bookmarking systems become crucial — tabbed grimoires, color-coded page edges, tactile markers for the blind",
            "Grimoires must be handled carefully; a torn page destroys the spell. Water damage, fire, insects — all existential threats",
            "A grimoire must be open and pressed to skin to cast, meaning one hand is always occupied",
            "Stolen grimoires are immediately usable by anyone with the will to activate them"
          ]
        },
        {
          name: "The Warrior — Body Casting",
          traits: ["Combat-ready", "Limited spell count", "Instant activation", "High preparation cost"],
          description: "Body casters draw glyphs directly on their skin under their clothes. Activation is instantaneous — pure will. But they're limited by body surface area and glyph size. Preparing for battle means stripping down and carefully inscribing spells, then dressing over them. Every spell slot is a strategic choice.",
          implications: [
            "Armor and heavy clothing may interfere — casters likely favor light, loose garments that don't smudge ink before activation",
            "Sweat, water, and physical abrasion could damage glyphs before use, creating environmental vulnerabilities",
            "A body caster who runs out of glyphs mid-fight is effectively a mundane combatant",
            "Mirror-writing on the back requires assistance — trusted allies or specialized tools become important",
            "The number of times you can cast a specific spell is decided before the fight begins"
          ]
        }
      ]
    }
  },
  {
    id: "blood",
    title: "Fey Blood Economy",
    icon: "✧",
    content: {
      methods: [
        {
          name: "Exchange — The Gift Economy",
          description: "Fey creatures trade their blood for gifts — but not valuable ones by human standards. A beautiful pinecone, the first fruits of harvest, a child's laughter captured in a bottle. Fey value aesthetics, novelty, sentiment, and natural beauty. This creates a magic economy based on wonder rather than wealth.",
          implications: [
            "A wealthy merchant can't simply buy more magical power — the Fey don't care about gold",
            "Those close to nature (farmers, foresters, children) may have the easiest access to Fey blood",
            "The Fey's alien sense of value means negotiations are unpredictable and culturally rich",
            "Entire professions could exist around finding and curating gifts that please specific Fey",
            "Seasonal availability — harvest time may be a boom period for blood acquisition",
            "Relationships with individual Fey become strategic assets"
          ]
        },
        {
          name: "Harvest — The Blood Farms",
          description: "Some keep Fey creatures captive and harvest their blood, like horseshoe crabs. This is efficient but ethically fraught — Fey are intelligent, magical beings. This creates an immediate moral axis in the world.",
          implications: [
            "Fey blood farms are likely controversial or outright illegal in some regions",
            "Harvested blood may be of lower quality — stressed or captive Fey might produce weaker ink",
            "Free Fey may refuse to trade with anyone associated with harvesters",
            "Liberation of captive Fey could be a major political and moral movement",
            "Industrial harvesting could cheapen magic, disrupting the gift economy",
            "The Fey realm (Arcadia) may retaliate against large-scale harvesting operations"
          ]
        }
      ]
    }
  },
  {
    id: "nuance",
    title: "Deep Nuances",
    icon: "◉",
    content: {
      nuances: [
        {
          category: "Combat Tactics",
          points: [
            "A grapple that strips clothing exposes and potentially smudges an enemy caster's remaining spells — anti-mage wrestling becomes a martial art",
            "Feinting spell use to make enemies believe you're out of glyphs, then revealing hidden ones",
            "Small glyphs = more spells but harder to write accurately. A caster's penmanship is literally their combat capacity",
            "Pre-battle preparation is everything. Intelligence about what you'll face determines your loadout",
            "Rain, mud, and swimming are natural enemies of body casters — waterproofing glyphs could be a specialized craft"
          ]
        },
        {
          category: "Social & Cultural",
          points: [
            "Seeing someone's glyph-covered body is deeply intimate — you're seeing their full magical capability and vulnerability",
            "Public baths, swimming, or any state of undress reveals a caster's preparations and intentions",
            "A caster covered in offensive glyphs in peacetime is threatening; defensive glyphs are more socially acceptable",
            "Tattoo artists and calligraphers would be highly valued if they can write precise, small glyphs",
            "Fashion evolves around the system — loose clothes that don't smudge, high collars to hide neck glyphs, long sleeves"
          ]
        },
        {
          category: "Economic & Political",
          points: [
            "Fey blood is the fundamental bottleneck of all magic — controlling supply means controlling power",
            "Nations with good Fey relations have a strategic magical advantage",
            "Counterfeit Fey blood (diluted or fake) would be a serious crime and market problem",
            "Blood preservation and shelf life create logistics challenges — does it expire? Does it need special storage?",
            "A single vial of Fey blood can become many glyphs — the ink-to-spell ratio determines everything"
          ]
        },
        {
          category: "Edge Cases & Exploits",
          points: [
            "Can you write a glyph on someone else's skin and have THEM activate it? Could you weaponize unwilling people?",
            "What happens if a glyph is only partially touching skin? Does it fizzle, misfire, or partially cast?",
            "Could you write glyphs on thin leather or parchment and press it to skin? A 'spell bandage' system?",
            "If the blood erases from existence, does the surface (skin/page) heal? Do body casters accumulate micro-scarring?",
            "Could a glyph be written so small it's invisible to the naked eye? Microscopic spellcasting?",
            "Can a sleeping or unconscious caster accidentally activate a glyph through dreams or instinct?"
          ]
        }
      ]
    }
  },
  {
    id: "purity",
    title: "Blood & Gold",
    icon: "⟡",
    content: {
      intro: "Not all Fey blood is equal, and not all magic is achievable. The distinction between diluted and pure blood creates a two-tier magical world — and the one thing pure blood can do that diluted cannot has reshaped economics, architecture, warfare, and the entire relationship between mortals and Fey.",
      bloodTiers: [
        {
          name: "Diluted Fey Blood — The Common Ink",
          color: "#7ec8e3",
          description: "Roughly 95% of all glyphwork in the world uses diluted Fey blood. Dilution stretches supply — a single vial of pure blood can be cut into many vials of working ink, making magic accessible to the wider population. Diluted blood powers every glyph school: evocation, warding, healing, transmutation, divination, illusion. For the vast majority of casters, diluted blood is the only ink they'll ever use, and it serves them completely.",
          implications: [
            "A dilution industry exists — blood-cutters who mix pure Fey blood with a carrier medium (likely alchemical) to precise ratios. Too thin and the glyphs fail; too rich and you're wasting precious pure stock",
            "Standard dilution ratios become regulated or guild-controlled. A '1-in-8 cut' versus a '1-in-20 cut' might produce different reliability or potency in the resulting glyphs",
            "Quality control matters enormously. A bad batch of diluted blood that fails mid-combat gets people killed. Blood assayers — specialists who test ink purity — become a critical profession",
            "Regional variation in dilution practices creates local magical 'flavors' — one city's standard ink might be slightly richer than another's, producing subtly different glyph behavior",
            "Counterfeit diluted blood (using animal blood or plant dyes with trace Fey blood) is a persistent black market problem — the glyph looks right but fizzles on activation"
          ]
        },
        {
          name: "Pure Fey Blood — The Sovereign Ink",
          color: "#f6c177",
          description: "Pure, undiluted Fey blood is the only medium that can produce displacement magic — teleportation. This is not a limitation of technique or knowledge; mortal scholarship has spent centuries trying to reproduce the effect with diluted ink and has categorically failed. Teleportation belongs to the Fey. Their blood carries some property that science cannot isolate, replicate, or synthesize. To teleport, you need their blood, full strength, no compromises.",
          implications: [
            "Pure blood is astronomically more expensive than diluted — perhaps 50 to 100 times the cost per vial. A single teleportation glyph might cost what a soldier earns in a year",
            "Governments, militaries, and the ultra-wealthy hoard pure blood as a strategic resource. National stockpiles are state secrets",
            "The Fey who willingly trade pure blood know exactly what it's used for, and they have enormous leverage in negotiations. The 'gift' they demand for a vial of pure blood might be extraordinary — a firstborn's name, a memory, a year of silence",
            "Fey who are harvested for pure blood are the most closely guarded captives — and the most motivated to escape or be rescued",
            "Fraud in the pure blood market is catastrophic. A caster who inscribes a teleportation glyph with secretly diluted blood discovers the deception only at the moment of activation — when the spell simply doesn't fire. If that moment is a battlefield extraction or an emergency escape, people die",
            "Authentication of pure blood becomes a high-stakes specialty. Some assayers can identify purity by color, viscosity, or the way the blood behaves when exposed to gold"
          ]
        }
      ],
      teleportation: {
        title: "Displacement Magic — The Fey Monopoly",
        description: "Teleportation is the great exception. Every other school of magic yields to study — learn the glyph, use the ink, produce the effect. But displacement defies mortal understanding. The Fey don't teleport through space the way a ball travels through air; they step sideways through Arcadia, the plane of magic itself, and re-emerge elsewhere. Pure Fey blood retains this planar affinity. Diluted blood, no matter the ratio, loses it completely — as though the connection to Arcadia frays below a certain concentration and spatial magic simply cannot hold.",
        implications: [
          "Teleportation isn't 'fast travel' — it's a brief transit through Arcadia itself. What a caster experiences during that fraction-of-a-second passage is a matter of intense academic debate and personal terror",
          "Because the effect is fundamentally alien, teleportation glyphs can't be refined or improved by mortal research the way other glyphs can. The glyph patterns for displacement were learned from the Fey or reverse-engineered from observation, not invented",
          "This creates a hard ceiling on mortal magical innovation — there are things the Fey can do that humans simply cannot reproduce, no matter how brilliant the scholar",
          "Military teleportation units are the most elite and expensive forces in existence — each activation burns irreplaceable pure blood. They're used for surgical strikes, extraction of VIPs, and assassination",
          "A caster who can reliably teleport is not just powerful — they're a strategic asset on par with a warship. Nations compete to recruit and retain them",
          "The Fey's ability to teleport freely, without glyphs or preparation, is a constant reminder of the power asymmetry between the planes. Mortals borrow. The Fey simply are."
        ]
      },
      gold: {
        title: "Gold — The Closed Circuit",
        description: "Gold is the one material that displacement magic cannot cross. Not iron, not silver, not enchanted steel — gold, specifically, creates a metaphysical boundary that spatial folding cannot penetrate. But only when it forms a complete, unbroken loop.",
        rules: [
          { rule: "The Closed Loop Rule", detail: "Gold must form a continuous, unbroken circuit to function as a barrier. A ring, a bracelet, a wire soldered into a perfect circle — any closed loop of gold creates an anti-displacement field within or upon whatever it encircles." },
          { rule: "Personal Protection", detail: "A creature wearing a continuous gold loop — ring, bracelet, anklet, toe ring — cannot be teleported, either by their own will or against it. The loop anchors them to their current position in space. This is both shield and shackle: you cannot be snatched, but you also cannot flee." },
          { rule: "Structural Barriers", detail: "A continuous strip of gold framing an opening — door, window, ventilation shaft — prevents teleportation through that opening. The gold doesn't need to be thick; a wire-thin inlay is sufficient. But it must be truly continuous, with no joint, seam, or gap." },
          { rule: "The Fracture Vulnerability", detail: "A gap of a fraction of a millimeter is enough to break the circuit and neutralize the barrier entirely. A scratched ring, a gouged inlay, a corroded joint — any discontinuity, no matter how small, renders the gold worthless as a ward. Maintenance is everything." }
        ],
        tacticalUses: [
          {
            name: "Mage Prisons",
            color: "#f6c177",
            text: "Cells designed to hold teleportation-capable casters feature gold inlays running continuously around every door frame, window frame, and ventilation shaft. These inlays are often concealed behind masonry or plaster to prevent prisoners from locating and scratching them. The most secure facilities use multiple redundant loops — scratch one, and three more still hold. Prison architects who specialize in gold-circuit design are rare, expensive, and themselves potential security risks.",
            details: [
              "Guards must inspect inlays regularly for corrosion, stress fractures, and deliberate tampering — a job requiring jeweler-grade precision",
              "The gold in a single high-security cell might be worth more than the building that houses it",
              "Some prisons use decoy inlays of gold-plated copper alongside real ones, forcing escapees to guess which to target",
              "Temperature fluctuations can cause microscopic gaps in gold inlays — climate-controlled cells are a luxury that prisons can't afford to skip"
            ]
          },
          {
            name: "Noble & VIP Protection",
            color: "#c4a7e7",
            text: "Paranoid nobility and high-value targets wear hidden gold loops as personal anti-teleportation wards. Gold toe rings beneath boots, continuous gold threading woven into undershirts, thin gold wire anklets beneath stockings. The goal is protection that can't be seen — if an assassin doesn't know you're warded, they waste their irreplaceable pure blood on a failed extraction, and you've learned someone wants you dead.",
            details: [
              "Gold-threaded undergarments are a luxury product made by specialist tailors who understand the closed-loop requirement — every thread must connect back to itself without a break",
              "A noble removing their gold before bed is vulnerable — nighttime is the most dangerous hour, so many sleep wearing their wards",
              "Bodyguards of important figures sometimes wear gold rings linked by fine chain, creating a cooperative ward zone",
              "The fashion of noble high collars and sealed cuffs dovetails perfectly — heavy clothing conceals the gold beneath, and the gold protects against the threat the clothing can't stop"
            ]
          },
          {
            name: "Harvester Compounds",
            color: "#eb6f92",
            text: "Blood harvesters live in a state of existential dread. They keep captive Fey — intelligent, magical beings with kin who can appear anywhere without warning. Free Fey can teleport at will, without glyphs, without preparation. A harvester compound without gold protection is a death trap waiting to happen. These facilities are fortified with continuous gold circuits around every opening: doors, windows, chimneys, drain grates, even gaps between foundation stones. Workers inside wear personal gold at all times.",
            details: [
              "Harvester compounds are the single largest non-monetary consumers of gold in the world — the architecture budget dwarfs the construction budget",
              "The compounds themselves become tempting theft targets: walls literally laced with gold, defended by people already hated by polite society",
              "Fey retaliation against harvesters is legendary — stories of compounds where the gold failed and what the Fey did next are campfire horror tales",
              "Some harvesters employ dedicated 'circuit walkers' whose only job is to inspect every inch of gold in the facility on a rotating schedule, looking for the tiniest flaw",
              "New harvester compounds are built with the gold circuits cast directly into the masonry — poured molten into channels in the stone — to make theft as destructive and obvious as possible",
              "Despite all precautions, successful Fey raids on harvester compounds happen. The aftermath is always the same: empty cages, broken gold, and missing staff who are never found"
            ]
          }
        ],
        economicImplications: [
          "Gold's dual value — monetary AND defensive — drives its price far above what pure economics would predict. It's simultaneously currency, jewelry, and the only anti-teleportation material in existence",
          "Nations with gold mines have both economic wealth and magical-security advantages, making them geopolitically dominant",
          "Gold theft from protected buildings isn't just robbery — it's potentially an act of war, removing a target's teleportation defenses before a strike",
          "The 'gold standard' takes on literal meaning: a nation's gold reserves determine both its economic stability and its vulnerability to magical assault",
          "Goldsmiths who can create truly seamless, unbroken circuits are among the most valued artisans alive — a single flaw in their work could cost lives",
          "Insurance against gold-circuit failure is a major industry. Who pays when a prison break succeeds because a joint corroded?",
          "Common folk generally cannot afford gold wards. Teleportation protection is, by economic necessity, a privilege of the wealthy — creating a stark security divide between classes"
        ],
        culturalDetails: [
          "Wedding rings take on a profound second meaning — 'I bind myself to you, and I ward you against being taken from me.' A broken wedding ring is both an emotional and a security catastrophe",
          "Gifting a gold ring to someone is simultaneously romantic and protective — the gesture carries weight that pure sentimentality doesn't capture",
          "Children of wealthy families wear gold bangles from infancy — not as decoration, but as kidnapping prevention",
          "Gold teeth, once a mark of wealth, become a mark of paranoia — the loop doesn't work (it's not a closed circuit), but people try anyway out of misunderstanding",
          "The phrase 'break the ring' becomes a common idiom meaning to betray someone's trust or remove their protection",
          "Removing all gold before entering certain spaces — temples, diplomatic chambers — becomes a gesture of vulnerability and good faith, similar to disarming",
          "There's a persistent folk belief that gold worn close to the heart wards against more than just teleportation, leading to gold locket traditions with no actual magical basis"
        ]
      }
    }
  },
  {
    id: "fashion",
    title: "Fashion & Dress",
    icon: "❋",
    content: {
      intro: "In a world where bare skin reveals magical intent and capability, clothing becomes armor of a different kind — not against blades, but against information. Fashion evolves along class lines, each style a silent statement about power, trust, and what the wearer wants you to know.",
      styles: [
        {
          name: "Common Folk — The Loose Drape",
          color: "#7ec8e3",
          tagline: "Comfort, practicality, and the culture of honest skin",
          garments: [
            "Wide-sleeved tunics and blouses that hang free from the body, leaving air between cloth and skin",
            "Loose trousers gathered at the ankle with a drawstring, easily rolled to the knee",
            "Open-front vests and unbuttoned overshirts — layers that can be shed or adjusted quickly",
            "Soft, breathable linen and cotton — fabrics that don't cling or press against skin, letting glyphs 'breathe' without smudging",
            "Rope belts and loose sashes rather than fitted waistbands"
          ],
          culture: "Among common people, loose clothing is a cultural norm rooted in practicality. Farmers, tradespeople, and townsfolk may carry a utility glyph or two — a healing charm, a fire-starter, a ward against vermin — and loose clothing protects these investments from sweat and friction. But more importantly, the loose drape is a social contract. Rolling up a sleeve or lifting a trouser leg to show bare, glyph-free skin is a casual gesture of peace. It says: I have nothing prepared against you. This 'showing of skin' becomes a greeting ritual in some communities, as ordinary as a handshake. Refusing to show skin isn't illegal, but it's noticed — the way someone keeping their hands in their pockets might be noticed in a tense room.",
          details: [
            "Sleeves are designed to roll and stay rolled — toggles, ties, or wide cuffs that fold back cleanly",
            "Necklines tend to be wide or unlaced, making it easy to pull a collar aside and show the collarbone and upper chest",
            "Children's clothing is often sleeveless or short-sleeved, a visible marker of innocence — they carry no glyphs",
            "In hot climates, common fashion trends toward minimal coverage naturally, making glyph-reading even more embedded in daily social interaction",
            "Pockets are external — sewn onto the outside of garments — so no one suspects hidden grimoire pages"
          ]
        },
        {
          name: "Nobility — The Sealed Silhouette",
          color: "#f6c177",
          tagline: "Maximum coverage, minimum disclosure",
          garments: [
            "High-collared doublets and coats, often boned or stiffened to stand upright against the jaw — no one peers down a noble's neckline",
            "Buttoned wrist cuffs, often double-layered, that seal the sleeve tight against the forearm",
            "Full-length gloves for formal occasions, eliminating hand-reading entirely",
            "Floor-length skirts, layered robes, and high boots — the legs are never visible",
            "Heavy, structured fabrics: brocade, velvet, layered silk — garments that hold their shape and reveal nothing of the body beneath"
          ],
          culture: "Noble fashion is information warfare worn as elegance. The high collar, the buttoned cuff, the layered robe — every design choice exists to deny observers any glimpse of the skin beneath. A noble at court might carry dozens of glyphs or none at all, and their clothing ensures no one can tell the difference. This ambiguity IS the power. A duke who may or may not be inscribed with lethal combat glyphs is far more dangerous politically than one whose bare arms prove he isn't. The sealed silhouette also serves a defensive purpose: if assassination by glyph-inscription is possible, covering every inch of accessible skin makes it harder for an enemy to mark you without your knowledge.",
          details: [
            "Buttons, clasps, and lacing are deliberately complex — a noble's garments cannot be casually opened or pulled aside, making forced glyph-reading a physical struggle",
            "Collar height is a subtle status signal: the higher the collar, the more the wearer has to hide (or wants you to think they do)",
            "Court etiquette forbids requesting that a noble show skin — it's considered an accusation of hostile intent",
            "Some noble houses develop signature closure styles: a particular arrangement of clasps becomes a family identifier",
            "Formal mourning dress covers even more — veils, hoods, full gloves — making funerals a uniquely tense environment politically",
            "'Undressing' before a monarch or liege — removing gloves and opening the collar — becomes a profound act of fealty, showing you have disarmed yourself"
          ]
        },
        {
          name: "Courtesans & Companions — The Deliberate Reveal",
          color: "#eb6f92",
          tagline: "Intimacy as currency, skin as trust",
          garments: [
            "Sheer overlays — fabrics that suggest skin without revealing it, a visual tease of what might or might not be inscribed beneath",
            "Strategic cutouts and asymmetric hems: one shoulder bare, one draped; one arm gloved, one not",
            "Wrap-style garments that can be opened in stages, turning the act of revealing skin into a ritual",
            "Bare midriffs or open backs paired with covered arms — showing safe zones while keeping potential glyph-sites hidden",
            "Body chains and decorative ink (non-magical) that mimic or obscure real glyph patterns"
          ],
          culture: "In a world where showing bare skin is an act of trust and vulnerability, courtesans and companions occupy a unique social niche. Their profession involves the most intimate form of disclosure: letting another person see your body and confirm what is or isn't written there. This makes companionship not merely physical but deeply political. A courtesan who has seen a noble's glyph loadout knows their magical capability and intent — information worth more than gold. The fashion of this class walks a razor's edge between allure and concealment, offering the promise of disclosure without giving it away for free. Every garment is designed to be removed in stages, each layer a negotiation.",
          details: [
            "Decorative false-glyphs painted in mundane ink become fashionable — they obscure which marks are real and which are ornamental, adding mystery",
            "The 'clean skin' courtesan — one who demonstrably carries no glyphs — becomes a luxury service, as clients can be certain they're safe in their presence",
            "High-end companions develop reputations for discretion about what they've seen inscribed on clients, making them trusted confidants of the powerful",
            "Some courtesans learn to read glyphs, becoming informal intelligence agents — fashion and espionage intertwined",
            "Gifting a companion a garment with fewer layers is an intimate gesture; gifting one with more layers is a statement of professional respect"
          ]
        },
        {
          name: "Laborers & Soldiers — The Functional Strip",
          color: "#9ccfd8",
          tagline: "Skin as proof of work and readiness",
          garments: [
            "Sleeveless tunics and short trousers for physical laborers — bare arms and legs prove no hostile glyphs and allow free movement",
            "Smiths and foundry workers wear heavy aprons over bare chests — the heat demands exposed skin, which coincidentally proves them unarmed",
            "Soldiers' uniforms include designated 'glyph windows': reinforced panels that open to expose inscribed skin for rapid casting",
            "Dock workers and sailors favor open shirts and rolled sleeves as a permanent state — the sea would ruin glyphs anyway",
            "Miners wear close-fitted caps and head wraps to protect the scalp, one of the few places a hidden glyph could survive heavy labor"
          ],
          culture: "For the working class, fashion is dictated first by function and second by the social expectation that honest labor requires honest skin. A blacksmith with covered arms raises suspicion — what's he hiding under there? Physical work naturally exposes the body, and this exposure has become a marker of trustworthiness among laborers. You can see that the dockhand has no combat glyphs; you can see the mason's arms are bare. Military fashion takes the opposite approach within the same logic: soldiers are expected to be armed, and their uniforms are designed to make glyph access fast. Flap-panels over the chest, forearms, and thighs can be torn open in a second, exposing prepared glyphs for rapid combat casting.",
          details: [
            "Guilds sometimes require members to show bare forearms during meetings — a collective 'we are unarmed among friends' gesture",
            "Farmers during harvest season work in minimal clothing, which doubles as a community safety signal during the most economically vulnerable time of year",
            "Military officers wear more coverage than enlisted soldiers — mirroring noble fashion, their authority is partly maintained by the uncertainty of their loadout",
            "Veteran soldiers often have faint scarring or slight discoloration where countless glyphs have been inscribed and burned away over years of service",
            "Retired soldiers who still show glyph-scars are treated with a mix of respect and wariness — the marks of someone who has cast and survived"
          ]
        },
        {
          name: "Mages & Academics — The Paradox Robe",
          color: "#c4a7e7",
          tagline: "Openly armed, openly trusted",
          garments: [
            "Long, open-fronted robes worn over close-fitting undergarments — the robe provides modesty while the underlayer sits directly against inscribed skin",
            "Wide sleeves that can be pushed back to expose entire forearms rapidly — the mage's 'quick-draw'",
            "Sash belts with loops for vials of Fey blood ink and small brushes — the tools of the trade worn openly",
            "Sandals or bare feet in academic settings, as even the feet and ankles are potential glyph space",
            "Spectacles or loupes worn on chains — for reading and writing micro-glyphs"
          ],
          culture: "Professional casters exist in a social paradox: everyone knows they're heavily inscribed, and that's precisely why they're trusted. A mage in an open robe with visible glyph-work on their forearms is declaring their capability openly, which is the opposite of a threat in this culture. It's the hidden glyph that's dangerous. Academic mages wear their inscriptions with the same casual pride a scholar might display ink-stained fingers — it's proof of their work. Their robes are designed for rapid access rather than concealment, and the open display of ink vials and brushes signals that they view magic as a craft, not a weapon. The traditional mage's robe, loose and layered, evolved because it's the ideal garment for someone who needs to access almost any part of their body at a moment's notice.",
          details: [
            "Different magical institutions develop distinctive robe styles, making a mage's training identifiable at a glance",
            "The tradition of 'bare hands' among mages — never wearing gloves — signals that they consider their hands their most important glyph-space and won't hide them",
            "Senior mages with decades of casting behind them have noticeably pale or smooth patches of skin where glyph-burn has accumulated — a mark of experience",
            "Apprentices often wear short sleeves to show their first practice glyphs, a rite of passage and source of pride",
            "Mage robes deliberately contrast with noble fashion — where nobles seal themselves shut, mages open themselves up, and each choice is a power statement"
          ]
        }
      ],
      coda: "What emerges is a world where getting dressed is a strategic act. The gap between a rolled-up sleeve and a buttoned cuff contains entire volumes of social information — about class, intent, trustworthiness, and power. A character's wardrobe tells you who they are, who they serve, and what they might be capable of, all without a word spoken."
    }
  }
];

const GlyphSVG = ({ size = 40, animate = false, color = "#c4a7e7" }) => (
  <svg width={size} height={size} viewBox="0 0 60 60" style={{ opacity: animate ? undefined : 0.7 }}>
    <defs>
      {animate && (
        <filter id="glow">
          <feGaussianBlur stdDeviation="3" result="blur" />
          <feMerge><feMergeNode in="blur" /><feMergeNode in="SourceGraphic" /></feMerge>
        </filter>
      )}
    </defs>
    <g filter={animate ? "url(#glow)" : undefined} stroke={color} fill="none" strokeWidth="1.5">
      <circle cx="30" cy="30" r="22" strokeDasharray="4 3" />
      <circle cx="30" cy="30" r="14" />
      <path d="M30 8 L30 16 M30 44 L30 52 M8 30 L16 30 M44 30 L52 30" />
      <path d="M18 18 L24 24 M36 36 L42 42 M42 18 L36 24 M24 36 L18 42" strokeWidth="1" />
      <path d="M30 16 L38 24 L38 36 L30 44 L22 36 L22 24 Z" strokeWidth="1" strokeDasharray="2 2" />
    </g>
    {animate && (
      <circle cx="30" cy="30" r="26" stroke={color} fill="none" strokeWidth="0.5" opacity="0.4">
        <animate attributeName="r" from="22" to="30" dur="2s" repeatCount="indefinite" />
        <animate attributeName="opacity" from="0.6" to="0" dur="2s" repeatCount="indefinite" />
      </circle>
    )}
  </svg>
);

const BodyDiagram = ({ allocations, onZoneClick, selectedZone }) => {
  const visibleZones = BODY_ZONES.filter(z => !z.hidden);
  return (
    <div style={{ position: "relative", width: "100%", maxWidth: 300, height: 420, margin: "0 auto" }}>
      <svg viewBox="0 0 100 95" style={{ width: "100%", height: "100%" }}>
        <defs>
          <linearGradient id="bodyGrad" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stopColor="#3a2a4a" />
            <stop offset="100%" stopColor="#2a1a3a" />
          </linearGradient>
        </defs>
        {/* Body silhouette */}
        <ellipse cx="50" cy="10" rx="8" ry="8" fill="url(#bodyGrad)" stroke="#6e5a8e" strokeWidth="0.5" />
        <rect x="44" y="14" width="12" height="4" rx="2" fill="url(#bodyGrad)" stroke="#6e5a8e" strokeWidth="0.3" />
        <path d="M38 18 Q38 16 44 17 L56 17 Q62 16 62 18 L64 35 Q65 40 60 40 L58 40 L56 45 L44 45 L42 40 L40 40 Q35 40 36 35 Z" fill="url(#bodyGrad)" stroke="#6e5a8e" strokeWidth="0.5" />
        {/* Arms */}
        <path d="M36 19 Q28 22 26 34 Q24 42 22 50 Q20 55 18 56" fill="none" stroke="#6e5a8e" strokeWidth="5" strokeLinecap="round" />
        <path d="M64 19 Q72 22 74 34 Q76 42 78 50 Q80 55 82 56" fill="none" stroke="#6e5a8e" strokeWidth="5" strokeLinecap="round" />
        {/* Legs */}
        <path d="M44 45 Q42 50 41 60 Q40 70 39 80 Q38 88 38 92" fill="none" stroke="#6e5a8e" strokeWidth="6" strokeLinecap="round" />
        <path d="M56 45 Q58 50 59 60 Q60 70 61 80 Q62 88 62 92" fill="none" stroke="#6e5a8e" strokeWidth="6" strokeLinecap="round" />

        {visibleZones.map(zone => {
          const count = allocations[zone.id] || 0;
          const isSelected = selectedZone === zone.id;
          const intensity = Math.min(count / (zone.smallMax || 10), 1);
          return (
            <g key={zone.id} onClick={() => onZoneClick(zone.id)} style={{ cursor: "pointer" }}>
              <rect
                x={zone.x - zone.w / 2} y={zone.y - zone.h / 2}
                width={zone.w} height={zone.h} rx="2"
                fill={count > 0 ? `rgba(196, 167, 231, ${0.15 + intensity * 0.4})` : "rgba(110, 90, 142, 0.1)"}
                stroke={isSelected ? "#f6c177" : count > 0 ? "#c4a7e7" : "#6e5a8e"}
                strokeWidth={isSelected ? "1" : "0.5"}
                strokeDasharray={isSelected ? "none" : "2 1"}
              />
              {count > 0 && (
                <text x={zone.x} y={zone.y + 1.5} textAnchor="middle" fill="#e0d6f0" fontSize="5" fontWeight="bold">{count}</text>
              )}
            </g>
          );
        })}
      </svg>
    </div>
  );
};

function MagicSystemCompendium() {
  const [activeSection, setActiveSection] = useState("mechanics");
  const [allocations, setAllocations] = useState({});
  const [selectedZone, setSelectedZone] = useState(null);
  const [glyphSize, setGlyphSize] = useState("small");
  const [activatingGlyph, setActivatingGlyph] = useState(false);

  const totalGlyphs = Object.values(allocations).reduce((a, b) => a + b, 0);
  const currentZone = BODY_ZONES.find(z => z.id === selectedZone);
  const maxForZone = currentZone ? (glyphSize === "small" ? currentZone.smallMax : currentZone.largeMax) : 0;
  const currentCount = selectedZone ? (allocations[selectedZone] || 0) : 0;

  const addGlyph = () => {
    if (!selectedZone || currentCount >= maxForZone) return;
    setAllocations(prev => ({ ...prev, [selectedZone]: (prev[selectedZone] || 0) + 1 }));
  };

  const removeGlyph = () => {
    if (!selectedZone || currentCount <= 0) return;
    setAllocations(prev => {
      const next = { ...prev, [selectedZone]: prev[selectedZone] - 1 };
      if (next[selectedZone] <= 0) delete next[selectedZone];
      return next;
    });
  };

  const clearAll = () => { setAllocations({}); setSelectedZone(null); };

  const simulateCast = () => {
    if (totalGlyphs === 0) return;
    setActivatingGlyph(true);
    setTimeout(() => {
      const keys = Object.keys(allocations).filter(k => allocations[k] > 0);
      if (keys.length > 0) {
        const randomKey = keys[Math.floor(Math.random() * keys.length)];
        setAllocations(prev => {
          const next = { ...prev, [randomKey]: prev[randomKey] - 1 };
          if (next[randomKey] <= 0) delete next[randomKey];
          return next;
        });
      }
      setActivatingGlyph(false);
    }, 1500);
  };

  const section = ANALYSIS_SECTIONS.find(s => s.id === activeSection);

  return (
    <div style={{
      minHeight: "100vh",
      background: "linear-gradient(170deg, #0d0a14 0%, #1a1225 40%, #0f0c18 100%)",
      color: "#d4cde0",
      fontFamily: "'Palatino Linotype', 'Book Antiqua', Palatino, Georgia, serif",
      padding: 0,
      margin: 0,
    }}>
      {/* Grain overlay */}
      <div style={{
        position: "fixed", inset: 0, pointerEvents: "none", zIndex: 100, opacity: 0.03,
        backgroundImage: `url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E")`,
      }} />

      {/* Header */}
      <header style={{
        padding: "48px 24px 32px",
        textAlign: "center",
        borderBottom: "1px solid rgba(196, 167, 231, 0.15)",
        background: "linear-gradient(180deg, rgba(196,167,231,0.06) 0%, transparent 100%)",
      }}>
        <div style={{ display: "flex", justifyContent: "center", marginBottom: 16, opacity: 0.6 }}>
          <GlyphSVG size={48} animate={true} />
        </div>
        <h1 style={{
          fontSize: "clamp(1.6rem, 4vw, 2.4rem)",
          fontWeight: 400,
          color: "#e8e0f0",
          letterSpacing: "0.15em",
          textTransform: "uppercase",
          margin: "0 0 8px",
        }}>
          The Glyph System
        </h1>
        <p style={{
          fontSize: "0.85rem",
          color: "#8a7ea0",
          letterSpacing: "0.3em",
          textTransform: "uppercase",
          margin: 0,
        }}>
          Fey Blood Arcana — Analysis & Compendium
        </p>
      </header>

      {/* Navigation */}
      <nav style={{
        display: "flex",
        gap: 0,
        borderBottom: "1px solid rgba(196, 167, 231, 0.1)",
        overflowX: "auto",
        WebkitOverflowScrolling: "touch",
      }}>
        {ANALYSIS_SECTIONS.map(s => (
          <button
            key={s.id}
            onClick={() => setActiveSection(s.id)}
            style={{
              flex: "1 0 auto",
              padding: "14px 16px",
              background: activeSection === s.id
                ? "linear-gradient(180deg, rgba(196,167,231,0.12) 0%, transparent 100%)"
                : "transparent",
              border: "none",
              borderBottom: activeSection === s.id ? "2px solid #c4a7e7" : "2px solid transparent",
              color: activeSection === s.id ? "#e0d6f0" : "#6e5a8e",
              fontFamily: "inherit",
              fontSize: "0.75rem",
              letterSpacing: "0.1em",
              textTransform: "uppercase",
              cursor: "pointer",
              transition: "all 0.3s ease",
              whiteSpace: "nowrap",
            }}
          >
            <span style={{ marginRight: 6, fontSize: "1rem" }}>{s.icon}</span>
            {s.title}
          </button>
        ))}
        <button
          onClick={() => setActiveSection("simulator")}
          style={{
            flex: "1 0 auto",
            padding: "14px 16px",
            background: activeSection === "simulator"
              ? "linear-gradient(180deg, rgba(246,193,119,0.12) 0%, transparent 100%)"
              : "transparent",
            border: "none",
            borderBottom: activeSection === "simulator" ? "2px solid #f6c177" : "2px solid transparent",
            color: activeSection === "simulator" ? "#f6c177" : "#6e5a8e",
            fontFamily: "inherit",
            fontSize: "0.75rem",
            letterSpacing: "0.1em",
            textTransform: "uppercase",
            cursor: "pointer",
            transition: "all 0.3s ease",
            whiteSpace: "nowrap",
          }}
        >
          <span style={{ marginRight: 6, fontSize: "1rem" }}>⬡</span>
          Simulator
        </button>
      </nav>

      {/* Content */}
      <main style={{ maxWidth: 800, margin: "0 auto", padding: "32px 20px 64px" }}>

        {/* Analysis Sections */}
        {section && activeSection !== "simulator" && (
          <div>
            <h2 style={{
              fontSize: "1.4rem",
              fontWeight: 400,
              color: "#e0d6f0",
              letterSpacing: "0.08em",
              marginBottom: 32,
              display: "flex",
              alignItems: "center",
              gap: 12,
            }}>
              <span style={{ color: "#c4a7e7", fontSize: "1.6rem" }}>{section.icon}</span>
              {section.title}
            </h2>

            {/* Mechanics */}
            {activeSection === "mechanics" && section.content.principles.map((p, i) => (
              <div key={i} style={{
                marginBottom: 28,
                padding: "20px 24px",
                background: "rgba(196, 167, 231, 0.04)",
                borderLeft: "2px solid rgba(196, 167, 231, 0.3)",
                borderRadius: "0 6px 6px 0",
              }}>
                <h3 style={{
                  fontSize: "1rem",
                  fontWeight: 600,
                  color: "#c4a7e7",
                  margin: "0 0 10px",
                  letterSpacing: "0.04em",
                }}>{p.name}</h3>
                <p style={{
                  margin: 0,
                  lineHeight: 1.75,
                  fontSize: "0.92rem",
                  color: "#b8aece",
                }}>{p.text}</p>
              </div>
            ))}

            {/* Casting Paradigms */}
            {activeSection === "casting" && section.content.paradigms.map((p, i) => (
              <div key={i} style={{
                marginBottom: 36,
                padding: "24px",
                background: "rgba(196, 167, 231, 0.03)",
                border: "1px solid rgba(196, 167, 231, 0.1)",
                borderRadius: 8,
              }}>
                <div style={{ display: "flex", alignItems: "baseline", gap: 12, marginBottom: 8, flexWrap: "wrap" }}>
                  <h3 style={{ fontSize: "1.1rem", color: "#e0d6f0", margin: 0, fontWeight: 500 }}>{p.name}</h3>
                  <div style={{ display: "flex", gap: 6, flexWrap: "wrap" }}>
                    {p.traits.map(t => (
                      <span key={t} style={{
                        fontSize: "0.65rem",
                        padding: "2px 8px",
                        background: "rgba(196, 167, 231, 0.12)",
                        borderRadius: 20,
                        color: "#c4a7e7",
                        letterSpacing: "0.05em",
                        textTransform: "uppercase",
                      }}>{t}</span>
                    ))}
                  </div>
                </div>
                <p style={{ lineHeight: 1.75, fontSize: "0.92rem", color: "#b8aece", margin: "12px 0 16px" }}>
                  {p.description}
                </p>
                <div style={{ borderTop: "1px solid rgba(196,167,231,0.08)", paddingTop: 14 }}>
                  <h4 style={{ fontSize: "0.7rem", color: "#8a7ea0", letterSpacing: "0.15em", textTransform: "uppercase", margin: "0 0 10px" }}>
                    World Implications
                  </h4>
                  {p.implications.map((imp, j) => (
                    <div key={j} style={{
                      display: "flex", gap: 10, marginBottom: 8, alignItems: "flex-start",
                    }}>
                      <span style={{ color: "#c4a7e7", fontSize: "0.6rem", marginTop: 6, flexShrink: 0 }}>◆</span>
                      <span style={{ fontSize: "0.88rem", lineHeight: 1.6, color: "#a89bbe" }}>{imp}</span>
                    </div>
                  ))}
                </div>
              </div>
            ))}

            {/* Blood Economy */}
            {activeSection === "blood" && section.content.methods.map((m, i) => (
              <div key={i} style={{
                marginBottom: 36,
                padding: "24px",
                background: i === 0
                  ? "linear-gradient(135deg, rgba(126,200,227,0.05), rgba(196,167,231,0.03))"
                  : "linear-gradient(135deg, rgba(235,111,146,0.05), rgba(196,167,231,0.03))",
                border: `1px solid ${i === 0 ? "rgba(126,200,227,0.2)" : "rgba(235,111,146,0.2)"}`,
                borderRadius: 8,
              }}>
                <h3 style={{ fontSize: "1.1rem", color: i === 0 ? "#7ec8e3" : "#eb6f92", margin: "0 0 10px", fontWeight: 500 }}>
                  {m.name}
                </h3>
                <p style={{ lineHeight: 1.75, fontSize: "0.92rem", color: "#b8aece", margin: "0 0 16px" }}>
                  {m.description}
                </p>
                <div style={{ borderTop: `1px solid ${i === 0 ? "rgba(126,200,227,0.1)" : "rgba(235,111,146,0.1)"}`, paddingTop: 14 }}>
                  <h4 style={{ fontSize: "0.7rem", color: "#8a7ea0", letterSpacing: "0.15em", textTransform: "uppercase", margin: "0 0 10px" }}>
                    Implications
                  </h4>
                  {m.implications.map((imp, j) => (
                    <div key={j} style={{ display: "flex", gap: 10, marginBottom: 8, alignItems: "flex-start" }}>
                      <span style={{ color: i === 0 ? "#7ec8e3" : "#eb6f92", fontSize: "0.6rem", marginTop: 6, flexShrink: 0 }}>◆</span>
                      <span style={{ fontSize: "0.88rem", lineHeight: 1.6, color: "#a89bbe" }}>{imp}</span>
                    </div>
                  ))}
                </div>
              </div>
            ))}

            {/* Nuances */}
            {activeSection === "nuance" && section.content.nuances.map((n, i) => (
              <div key={i} style={{
                marginBottom: 28,
                padding: "20px 24px",
                background: "rgba(196, 167, 231, 0.03)",
                border: "1px solid rgba(196, 167, 231, 0.08)",
                borderRadius: 8,
              }}>
                <h3 style={{
                  fontSize: "0.8rem",
                  color: "#f6c177",
                  letterSpacing: "0.12em",
                  textTransform: "uppercase",
                  margin: "0 0 14px",
                  fontWeight: 600,
                }}>{n.category}</h3>
                {n.points.map((pt, j) => (
                  <div key={j} style={{ display: "flex", gap: 10, marginBottom: 10, alignItems: "flex-start" }}>
                    <span style={{ color: "#c4a7e7", fontSize: "0.55rem", marginTop: 7, flexShrink: 0 }}>◈</span>
                    <span style={{ fontSize: "0.88rem", lineHeight: 1.65, color: "#b8aece" }}>{pt}</span>
                  </div>
                ))}
              </div>
            ))}

            {/* Blood & Gold */}
            {activeSection === "purity" && (
              <div>
                {/* Intro */}
                <p style={{
                  fontSize: "0.95rem", lineHeight: 1.8, color: "#b8aece",
                  marginBottom: 32, fontStyle: "italic",
                  padding: "16px 20px",
                  borderLeft: "2px solid rgba(246,193,119,0.3)",
                  background: "rgba(246,193,119,0.03)",
                  borderRadius: "0 6px 6px 0",
                }}>
                  {section.content.intro}
                </p>

                {/* Blood Tiers */}
                {section.content.bloodTiers.map((tier, i) => (
                  <div key={i} style={{
                    marginBottom: 32,
                    padding: "24px",
                    background: `linear-gradient(165deg, ${tier.color}08, transparent 60%)`,
                    border: `1px solid ${tier.color}22`,
                    borderRadius: 10,
                  }}>
                    <h3 style={{ fontSize: "1.1rem", color: tier.color, margin: "0 0 10px", fontWeight: 500 }}>
                      {tier.name}
                    </h3>
                    <p style={{ lineHeight: 1.75, fontSize: "0.92rem", color: "#b8aece", margin: "0 0 18px" }}>
                      {tier.description}
                    </p>
                    <div style={{ borderTop: `1px solid ${tier.color}15`, paddingTop: 14 }}>
                      {tier.implications.map((imp, j) => (
                        <div key={j} style={{ display: "flex", gap: 10, marginBottom: 9, alignItems: "flex-start" }}>
                          <span style={{ color: tier.color, fontSize: "0.55rem", marginTop: 7, flexShrink: 0 }}>◆</span>
                          <span style={{ fontSize: "0.86rem", lineHeight: 1.6, color: "#a89bbe" }}>{imp}</span>
                        </div>
                      ))}
                    </div>
                  </div>
                ))}

                {/* Teleportation */}
                <div style={{
                  marginBottom: 32,
                  padding: "24px",
                  background: "linear-gradient(135deg, rgba(196,167,231,0.06), rgba(235,111,146,0.03))",
                  border: "1px solid rgba(196,167,231,0.15)",
                  borderRadius: 10,
                }}>
                  <h3 style={{ fontSize: "1.15rem", color: "#e0d6f0", margin: "0 0 6px", fontWeight: 500 }}>
                    {section.content.teleportation.title}
                  </h3>
                  <p style={{ lineHeight: 1.75, fontSize: "0.92rem", color: "#b8aece", margin: "8px 0 20px" }}>
                    {section.content.teleportation.description}
                  </p>
                  <div style={{ borderTop: "1px solid rgba(196,167,231,0.1)", paddingTop: 14 }}>
                    {section.content.teleportation.implications.map((imp, j) => (
                      <div key={j} style={{ display: "flex", gap: 10, marginBottom: 9, alignItems: "flex-start" }}>
                        <span style={{ color: "#c4a7e7", fontSize: "0.55rem", marginTop: 7, flexShrink: 0 }}>◈</span>
                        <span style={{ fontSize: "0.86rem", lineHeight: 1.6, color: "#a89bbe" }}>{imp}</span>
                      </div>
                    ))}
                  </div>
                </div>

                {/* Gold Divider */}
                <div style={{
                  display: "flex", alignItems: "center", gap: 16, margin: "40px 0 32px",
                }}>
                  <div style={{ flex: 1, height: 1, background: "linear-gradient(90deg, transparent, #f6c177, transparent)" }} />
                  <span style={{ fontSize: "0.7rem", color: "#f6c177", letterSpacing: "0.2em", textTransform: "uppercase", whiteSpace: "nowrap" }}>
                    ✧ Gold & The Closed Circuit ✧
                  </span>
                  <div style={{ flex: 1, height: 1, background: "linear-gradient(90deg, transparent, #f6c177, transparent)" }} />
                </div>

                {/* Gold Description */}
                <div style={{
                  marginBottom: 24,
                  padding: "20px 24px",
                  background: "rgba(246,193,119,0.04)",
                  borderLeft: "3px solid rgba(246,193,119,0.4)",
                  borderRadius: "0 6px 6px 0",
                }}>
                  <h3 style={{ fontSize: "1.1rem", color: "#f6c177", margin: "0 0 8px", fontWeight: 500 }}>
                    {section.content.gold.title}
                  </h3>
                  <p style={{ lineHeight: 1.75, fontSize: "0.92rem", color: "#b8aece", margin: 0 }}>
                    {section.content.gold.description}
                  </p>
                </div>

                {/* Gold Rules */}
                <div style={{
                  display: "grid",
                  gap: 10,
                  marginBottom: 32,
                }}>
                  {section.content.gold.rules.map((r, i) => (
                    <div key={i} style={{
                      padding: "14px 18px",
                      background: "rgba(246,193,119,0.03)",
                      border: "1px solid rgba(246,193,119,0.12)",
                      borderRadius: 6,
                      display: "flex", gap: 14, alignItems: "flex-start",
                    }}>
                      <div style={{
                        width: 28, height: 28, borderRadius: "50%",
                        border: "1.5px solid rgba(246,193,119,0.4)",
                        display: "flex", alignItems: "center", justifyContent: "center",
                        fontSize: "0.7rem", color: "#f6c177", flexShrink: 0,
                        marginTop: 2,
                      }}>{i + 1}</div>
                      <div>
                        <span style={{ fontSize: "0.88rem", color: "#f6c177", fontWeight: 600 }}>{r.rule}: </span>
                        <span style={{ fontSize: "0.86rem", lineHeight: 1.6, color: "#a89bbe" }}>{r.detail}</span>
                      </div>
                    </div>
                  ))}
                </div>

                {/* Tactical Uses */}
                <h3 style={{
                  fontSize: "0.72rem", color: "#8a7ea0", letterSpacing: "0.18em",
                  textTransform: "uppercase", margin: "0 0 16px", fontWeight: 600,
                }}>
                  Tactical & Structural Applications
                </h3>
                {section.content.gold.tacticalUses.map((use, i) => (
                  <div key={i} style={{
                    marginBottom: 28,
                    padding: "22px 24px",
                    background: `linear-gradient(165deg, ${use.color}06, transparent 50%)`,
                    border: `1px solid ${use.color}18`,
                    borderRadius: 8,
                  }}>
                    <h4 style={{ fontSize: "1rem", color: use.color, margin: "0 0 8px", fontWeight: 500 }}>
                      {use.name}
                    </h4>
                    <p style={{ lineHeight: 1.75, fontSize: "0.9rem", color: "#b8aece", margin: "0 0 14px" }}>
                      {use.text}
                    </p>
                    <div style={{ borderTop: `1px solid ${use.color}10`, paddingTop: 12 }}>
                      {use.details.map((d, j) => (
                        <div key={j} style={{ display: "flex", gap: 10, marginBottom: 8, alignItems: "flex-start" }}>
                          <span style={{ color: use.color, fontSize: "0.5rem", marginTop: 7, flexShrink: 0 }}>◆</span>
                          <span style={{ fontSize: "0.84rem", lineHeight: 1.6, color: "#a89bbe" }}>{d}</span>
                        </div>
                      ))}
                    </div>
                  </div>
                ))}

                {/* Economic Implications */}
                <div style={{
                  marginBottom: 28, padding: "20px 24px",
                  background: "rgba(246,193,119,0.03)",
                  border: "1px solid rgba(246,193,119,0.1)",
                  borderRadius: 8,
                }}>
                  <h4 style={{
                    fontSize: "0.72rem", color: "#f6c177", letterSpacing: "0.15em",
                    textTransform: "uppercase", margin: "0 0 14px", fontWeight: 600,
                  }}>Economic & Geopolitical Impact</h4>
                  {section.content.gold.economicImplications.map((imp, j) => (
                    <div key={j} style={{ display: "flex", gap: 10, marginBottom: 9, alignItems: "flex-start" }}>
                      <span style={{ color: "#f6c177", fontSize: "0.55rem", marginTop: 7, flexShrink: 0 }}>◈</span>
                      <span style={{ fontSize: "0.86rem", lineHeight: 1.6, color: "#a89bbe" }}>{imp}</span>
                    </div>
                  ))}
                </div>

                {/* Cultural Details */}
                <div style={{
                  marginBottom: 12, padding: "20px 24px",
                  background: "rgba(196,167,231,0.03)",
                  border: "1px solid rgba(196,167,231,0.08)",
                  borderRadius: 8,
                }}>
                  <h4 style={{
                    fontSize: "0.72rem", color: "#c4a7e7", letterSpacing: "0.15em",
                    textTransform: "uppercase", margin: "0 0 14px", fontWeight: 600,
                  }}>Cultural Resonance</h4>
                  {section.content.gold.culturalDetails.map((det, j) => (
                    <div key={j} style={{ display: "flex", gap: 10, marginBottom: 9, alignItems: "flex-start" }}>
                      <span style={{ color: "#c4a7e7", fontSize: "0.55rem", marginTop: 7, flexShrink: 0 }}>◈</span>
                      <span style={{ fontSize: "0.86rem", lineHeight: 1.6, color: "#a89bbe" }}>{det}</span>
                    </div>
                  ))}
                </div>
              </div>
            )}

            {/* Fashion & Dress */}
            {activeSection === "fashion" && (
              <div>
                {/* Intro */}
                <p style={{
                  fontSize: "0.95rem", lineHeight: 1.8, color: "#b8aece",
                  marginBottom: 32, fontStyle: "italic",
                  padding: "16px 20px",
                  borderLeft: "2px solid rgba(196,167,231,0.2)",
                  background: "rgba(196,167,231,0.03)",
                  borderRadius: "0 6px 6px 0",
                }}>
                  {section.content.intro}
                </p>

                {section.content.styles.map((s, i) => (
                  <div key={i} style={{
                    marginBottom: 40,
                    borderRadius: 10,
                    overflow: "hidden",
                    border: `1px solid ${s.color}22`,
                    background: `linear-gradient(165deg, ${s.color}08, transparent 60%)`,
                  }}>
                    {/* Style header */}
                    <div style={{
                      padding: "20px 24px 14px",
                      borderBottom: `1px solid ${s.color}15`,
                    }}>
                      <div style={{ display: "flex", alignItems: "baseline", gap: 12, flexWrap: "wrap" }}>
                        <h3 style={{ fontSize: "1.1rem", color: s.color, margin: 0, fontWeight: 500 }}>
                          {s.name}
                        </h3>
                      </div>
                      <p style={{
                        margin: "6px 0 0", fontSize: "0.78rem", color: "#8a7ea0",
                        fontStyle: "italic", letterSpacing: "0.03em",
                      }}>
                        {s.tagline}
                      </p>
                    </div>

                    <div style={{ padding: "18px 24px" }}>
                      {/* Garments */}
                      <h4 style={{
                        fontSize: "0.65rem", color: s.color, letterSpacing: "0.15em",
                        textTransform: "uppercase", margin: "0 0 10px", opacity: 0.8,
                      }}>
                        Characteristic Garments
                      </h4>
                      <div style={{
                        display: "grid",
                        gap: 6,
                        marginBottom: 20,
                        padding: "12px 16px",
                        background: "rgba(0,0,0,0.15)",
                        borderRadius: 6,
                      }}>
                        {s.garments.map((g, j) => (
                          <div key={j} style={{ display: "flex", gap: 10, alignItems: "flex-start" }}>
                            <span style={{ color: s.color, fontSize: "0.5rem", marginTop: 7, flexShrink: 0, opacity: 0.7 }}>▪</span>
                            <span style={{ fontSize: "0.84rem", lineHeight: 1.55, color: "#a89bbe" }}>{g}</span>
                          </div>
                        ))}
                      </div>

                      {/* Culture description */}
                      <h4 style={{
                        fontSize: "0.65rem", color: s.color, letterSpacing: "0.15em",
                        textTransform: "uppercase", margin: "0 0 10px", opacity: 0.8,
                      }}>
                        Cultural Context
                      </h4>
                      <p style={{
                        fontSize: "0.9rem", lineHeight: 1.75, color: "#b8aece",
                        margin: "0 0 20px",
                      }}>
                        {s.culture}
                      </p>

                      {/* Details */}
                      <div style={{
                        borderTop: `1px solid ${s.color}12`,
                        paddingTop: 14,
                      }}>
                        <h4 style={{
                          fontSize: "0.65rem", color: "#8a7ea0", letterSpacing: "0.15em",
                          textTransform: "uppercase", margin: "0 0 10px",
                        }}>
                          World Details
                        </h4>
                        {s.details.map((d, j) => (
                          <div key={j} style={{ display: "flex", gap: 10, marginBottom: 9, alignItems: "flex-start" }}>
                            <span style={{ color: s.color, fontSize: "0.55rem", marginTop: 7, flexShrink: 0 }}>◆</span>
                            <span style={{ fontSize: "0.86rem", lineHeight: 1.6, color: "#a89bbe" }}>{d}</span>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>
                ))}

                {/* Closing reflection */}
                <div style={{
                  marginTop: 12, padding: "20px 24px",
                  background: "linear-gradient(135deg, rgba(196,167,231,0.06), rgba(246,193,119,0.04))",
                  border: "1px solid rgba(196,167,231,0.12)",
                  borderRadius: 8,
                  textAlign: "center",
                }}>
                  <p style={{
                    fontSize: "0.92rem", lineHeight: 1.75, color: "#c4a7e7",
                    margin: 0, fontStyle: "italic",
                  }}>
                    {section.content.coda}
                  </p>
                </div>
              </div>
            )}
          </div>
        )}

        {/* Simulator */}
        {activeSection === "simulator" && (
          <div>
            <h2 style={{
              fontSize: "1.4rem", fontWeight: 400, color: "#e0d6f0",
              letterSpacing: "0.08em", marginBottom: 8,
              display: "flex", alignItems: "center", gap: 12,
            }}>
              <span style={{ color: "#f6c177", fontSize: "1.6rem" }}>⬡</span>
              Battle Preparation Simulator
            </h2>
            <p style={{ fontSize: "0.88rem", color: "#8a7ea0", marginBottom: 28, lineHeight: 1.6 }}>
              Plan your spell loadout as a body caster. Select body zones and inscribe glyphs — limited by surface area.
            </p>

            <div style={{ display: "flex", gap: 32, flexWrap: "wrap", alignItems: "flex-start" }}>
              {/* Body Diagram */}
              <div style={{ flex: "1 1 260px", minWidth: 260 }}>
                <div style={{
                  background: "rgba(196,167,231,0.04)",
                  border: "1px solid rgba(196,167,231,0.1)",
                  borderRadius: 8,
                  padding: "20px 12px",
                  position: "relative",
                }}>
                  {activatingGlyph && (
                    <div style={{
                      position: "absolute", inset: 0, borderRadius: 8, zIndex: 10,
                      background: "radial-gradient(circle, rgba(196,167,231,0.3) 0%, transparent 70%)",
                      animation: "pulse 1.5s ease-in-out",
                      pointerEvents: "none",
                    }} />
                  )}
                  <BodyDiagram
                    allocations={allocations}
                    onZoneClick={setSelectedZone}
                    selectedZone={selectedZone}
                  />
                  <div style={{ textAlign: "center", marginTop: 8 }}>
                    <span style={{ fontSize: "0.7rem", color: "#6e5a8e", letterSpacing: "0.1em" }}>
                      TAP A ZONE TO SELECT
                    </span>
                  </div>
                </div>

                {/* Totals */}
                <div style={{
                  marginTop: 16, padding: "12px 16px",
                  background: "rgba(246,193,119,0.06)",
                  border: "1px solid rgba(246,193,119,0.15)",
                  borderRadius: 6, textAlign: "center",
                }}>
                  <span style={{ fontSize: "2rem", color: "#f6c177", fontWeight: 300 }}>{totalGlyphs}</span>
                  <span style={{ fontSize: "0.7rem", color: "#8a7ea0", display: "block", letterSpacing: "0.15em", textTransform: "uppercase" }}>
                    Total Glyphs Inscribed
                  </span>
                </div>
              </div>

              {/* Controls */}
              <div style={{ flex: "1 1 280px", minWidth: 260 }}>
                {selectedZone && currentZone && !currentZone.hidden ? (
                  <div style={{
                    padding: "20px 24px",
                    background: "rgba(196,167,231,0.04)",
                    border: "1px solid rgba(196,167,231,0.15)",
                    borderRadius: 8,
                  }}>
                    <h3 style={{ margin: "0 0 4px", color: "#e0d6f0", fontSize: "1.05rem", fontWeight: 500 }}>
                      {currentZone.label}
                    </h3>
                    <p style={{ margin: "0 0 16px", fontSize: "0.78rem", color: "#6e5a8e" }}>
                      ~{currentZone.area}% body surface area
                    </p>

                    {/* Glyph size toggle */}
                    <div style={{ marginBottom: 16 }}>
                      <span style={{ fontSize: "0.65rem", color: "#8a7ea0", letterSpacing: "0.1em", textTransform: "uppercase", display: "block", marginBottom: 8 }}>
                        Glyph Complexity
                      </span>
                      <div style={{ display: "flex", gap: 6 }}>
                        {[["small", "Simple"], ["large", "Complex"]].map(([val, label]) => (
                          <button key={val} onClick={() => setGlyphSize(val)} style={{
                            padding: "6px 14px",
                            background: glyphSize === val ? "rgba(196,167,231,0.2)" : "rgba(196,167,231,0.05)",
                            border: `1px solid ${glyphSize === val ? "#c4a7e7" : "rgba(196,167,231,0.1)"}`,
                            borderRadius: 4,
                            color: glyphSize === val ? "#e0d6f0" : "#6e5a8e",
                            fontFamily: "inherit",
                            fontSize: "0.78rem",
                            cursor: "pointer",
                          }}>
                            {label}
                          </button>
                        ))}
                      </div>
                    </div>

                    {/* Count display */}
                    <div style={{ marginBottom: 16 }}>
                      <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 8 }}>
                        <span style={{ fontSize: "0.78rem", color: "#a89bbe" }}>Glyphs here</span>
                        <span style={{ fontSize: "1.2rem", color: "#e0d6f0" }}>
                          {currentCount} <span style={{ fontSize: "0.75rem", color: "#6e5a8e" }}>/ {maxForZone}</span>
                        </span>
                      </div>
                      {/* Progress bar */}
                      <div style={{
                        height: 4, background: "rgba(196,167,231,0.1)", borderRadius: 2, overflow: "hidden",
                      }}>
                        <div style={{
                          height: "100%",
                          width: `${maxForZone > 0 ? (currentCount / maxForZone) * 100 : 0}%`,
                          background: currentCount >= maxForZone ? "#eb6f92" : "#c4a7e7",
                          borderRadius: 2,
                          transition: "width 0.3s ease, background 0.3s ease",
                        }} />
                      </div>
                    </div>

                    {/* Buttons */}
                    <div style={{ display: "flex", gap: 8 }}>
                      <button onClick={addGlyph} disabled={currentCount >= maxForZone} style={{
                        flex: 1, padding: "10px", border: "none", borderRadius: 4,
                        background: currentCount >= maxForZone ? "rgba(110,90,142,0.2)" : "rgba(196,167,231,0.2)",
                        color: currentCount >= maxForZone ? "#4a3d60" : "#e0d6f0",
                        fontFamily: "inherit", fontSize: "0.85rem", cursor: currentCount >= maxForZone ? "not-allowed" : "pointer",
                      }}>
                        + Inscribe
                      </button>
                      <button onClick={removeGlyph} disabled={currentCount <= 0} style={{
                        flex: 1, padding: "10px", border: "none", borderRadius: 4,
                        background: currentCount <= 0 ? "rgba(110,90,142,0.2)" : "rgba(235,111,146,0.15)",
                        color: currentCount <= 0 ? "#4a3d60" : "#eb6f92",
                        fontFamily: "inherit", fontSize: "0.85rem", cursor: currentCount <= 0 ? "not-allowed" : "pointer",
                      }}>
                        − Remove
                      </button>
                    </div>

                    {currentCount >= maxForZone && (
                      <p style={{ fontSize: "0.75rem", color: "#eb6f92", marginTop: 10, marginBottom: 0, fontStyle: "italic" }}>
                        No more room — surface area exhausted for {glyphSize} glyphs.
                      </p>
                    )}
                  </div>
                ) : (
                  <div style={{
                    padding: "40px 24px", textAlign: "center",
                    background: "rgba(196,167,231,0.02)",
                    border: "1px dashed rgba(196,167,231,0.1)",
                    borderRadius: 8,
                  }}>
                    <GlyphSVG size={48} color="#6e5a8e" />
                    <p style={{ color: "#6e5a8e", fontSize: "0.85rem", marginTop: 12 }}>
                      Select a body zone on the diagram to begin inscribing glyphs.
                    </p>
                  </div>
                )}

                {/* Action buttons */}
                <div style={{ display: "flex", gap: 8, marginTop: 16 }}>
                  <button onClick={simulateCast} disabled={totalGlyphs === 0 || activatingGlyph} style={{
                    flex: 1, padding: "12px", border: "1px solid rgba(246,193,119,0.3)", borderRadius: 6,
                    background: totalGlyphs === 0 ? "rgba(110,90,142,0.1)" : "rgba(246,193,119,0.1)",
                    color: totalGlyphs === 0 ? "#4a3d60" : "#f6c177",
                    fontFamily: "inherit", fontSize: "0.82rem", cursor: totalGlyphs === 0 ? "not-allowed" : "pointer",
                    letterSpacing: "0.05em",
                  }}>
                    {activatingGlyph ? "✦ Casting..." : "✦ Cast Spell"}
                  </button>
                  <button onClick={clearAll} style={{
                    padding: "12px 16px", border: "1px solid rgba(235,111,146,0.2)", borderRadius: 6,
                    background: "rgba(235,111,146,0.05)",
                    color: "#eb6f92",
                    fontFamily: "inherit", fontSize: "0.82rem", cursor: "pointer",
                  }}>
                    Clear
                  </button>
                </div>

                {/* Zone legend */}
                <div style={{
                  marginTop: 24, padding: "16px",
                  background: "rgba(196,167,231,0.02)",
                  border: "1px solid rgba(196,167,231,0.06)",
                  borderRadius: 6,
                }}>
                  <h4 style={{ fontSize: "0.65rem", color: "#6e5a8e", letterSpacing: "0.15em", textTransform: "uppercase", margin: "0 0 10px" }}>
                    Zone Capacity Reference
                  </h4>
                  <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: "4px 12px" }}>
                    {BODY_ZONES.filter(z => !z.hidden).map(z => (
                      <div key={z.id} style={{
                        fontSize: "0.72rem", color: allocations[z.id] ? "#b8aece" : "#4a3d60",
                        display: "flex", justifyContent: "space-between",
                        padding: "2px 0",
                      }}>
                        <span>{z.label}</span>
                        <span style={{ color: "#6e5a8e" }}>{z.smallMax}</span>
                      </div>
                    ))}
                  </div>
                  <p style={{ fontSize: "0.65rem", color: "#4a3d60", margin: "8px 0 0", fontStyle: "italic" }}>
                    Capacities shown for simple glyphs. Complex glyphs use ~3× the space.
                  </p>
                </div>
              </div>
            </div>
          </div>
        )}
      </main>

      <style>{`
        @keyframes pulse {
          0% { opacity: 0; }
          50% { opacity: 1; }
          100% { opacity: 0; }
        }
        * { box-sizing: border-box; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: rgba(196,167,231,0.05); }
        ::-webkit-scrollbar-thumb { background: rgba(196,167,231,0.2); border-radius: 3px; }
      `}</style>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<MagicSystemCompendium />);
  </script>
</body>
</html>
